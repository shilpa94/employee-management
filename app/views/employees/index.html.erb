<p id="notice"><%= notice %></p>

<div class="container">
  <div class="row">
    <div class="col-8">
      <h1>Employees</h1>
    </div>
    <div class="col-4">
      <%= form_tag(employees_path, method: :get) do %>
        <%= text_field_tag :term %>
        <%= submit_tag 'Search' %>
      <% end %>
    </div>
    <!-- <div class="col-4"> -->
      <%#= form_tag(employees_path, method: :get) do %>
        <%#= select_tag "department", options_for_select(["IT", "Tester", "Developer", "Designer" ]) %>
        <%#= submit_tag 'Go' %>
      <%# end %>
    <!-- </div> -->


       <div>
         <select class="list">
           <option value="IT">IT</option>
           <option value="Designer">Designer</option>
           <option value="Tester">Tester</option>
           <option value="Developer">Developer</option>
         </select>

       </div>
    

  </div>
</div>

<table class="table">
  <thead>
    <tr>
      <th scope="col">Firstname</th>
      <th scope="col">Lastname</th>
      <th scope="col">Email</th>
      <th scope="col">Gender</th>
      <th scope="col">Phone</th>
      <th scope="col">Address</th>
      <th scope="col">Employee</th>
      <th scope="col">Department</th>
      <th scope="col">DOB</th>
      <th scope="col">Picture</th>


      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody class="render">
    <% @employees.each do |employee| %>
      <tr>
        <td><%= employee.firstname %></td>
        <td><%= employee.lastname %></td>
        <td><%= employee.email %></td>
        <td><%= employee.gender %></td>
        <td><%= employee.phone %></td>
        <td><%= employee.address %></td>
        <td><%= employee.employee_id %></td>
        <td><%= employee.department %></td>
        <td><%= employee.DOB %></td>
        <td><%= image_tag employee.picture_url, width: '40%' if employee.picture.present? %></td>
        <td><%= link_to 'Show', employee %></td>
        <td><%= link_to 'Edit', edit_employee_path(employee) %></td>
        <td><%= link_to 'Destroy', employee, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Employee', new_employee_path, class:"btn btn-primary" %>


<script type="text/javascript">
  $("select.list").change(function(){
      var depname= $(this).val();
      //alert("You have selected the department- " + depname);
        $.ajax({
          type: "GET", 
          url: "/employees",
          data: {department: depname},
          success: function(data, textStatus, jqXHR){
            console.log(data);
            $(".render").empty();
            $(".render").append(data);
          },
          error: function(jqXHR, textStatus, errorThrown){}
        })
      });
            
</script>